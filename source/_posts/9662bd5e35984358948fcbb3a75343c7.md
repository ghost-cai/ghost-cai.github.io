---
layout: post
title: 十一-注：Python （类型提示）指定参数类型以及参数注解
abbrlink: 9662bd5e35984358948fcbb3a75343c7
tags: []
categories:
  - 3.编程学习
  - Python Study-2022/9
date: 1665130614706
updated: 1665130790174
---

# Python （类型提示）指定参数类型以及参数注解

众所周知，Python 是动态类型语言，运行时不需要指定变量类型。这一点是不会改变的，但是2015年9月创始人 Guido van Rossum 在 Python 3.5 引入了一个类型系统，允许开发者指定变量类型–类型提示（Type Hints）。它的主要作用是方便开发，供IDE 和各种开发工具使用，对代码运行不产生影响，运行时会过滤类型信息。

主要优点如下：
1、易于理解代码
指定函数输入和输出，便于理解代码片段的过程。永远记住你阅读的代码，比你写的代码要多得多。
有了类型提示（Type Hints），在调用函数时就可以告诉你需要传递哪些参数类型；以及需要扩展/修改函数时，也会告诉你输入和输出所需要的数据类型。 例如，想象一下以下这个发送请求的函数，

```
def send_request(request_data : Any,
                 headers: Optional[Dict[str, str]],
                 user_id: Optional[UserId] = None,
                 as_json: bool = True):
```

只看这个函数签名，我们就可以知道：

request\_data可以是任何数据
header的内容是一个可选的字符串字典
UserId是可选的（默认为None），或者是符合编码UserId的任何数据
as\_json需要始终是一个布尔值（本质上是一个flag，即使名称可能没有提供这种提示）
而类型提示系统可以将类型信息从文档中移动到更加接近函数的接口，然后以一个明确定义的方式来声明复杂的类型要求。同时，构建linters，并在每次更改代码后运行它们，可以检查这些类型提示约束，确保它们永远不会过时。

2、 易于重构
类型提示可以在重构时，更好得帮助我们定位类的位置。

虽然许多IDE现在采用一些启发式方法提供了这项功能，但是类型提示可以使IDE具有100%的检测准确率，并定位到类的位置。这样可以更平滑，更准确地检测变量类型在代码中的运行方式。

请记住，虽然动态类型意味着任何变量都可以成为任何类型，但是所有变量在所有时间中都应只有一种类型。类型系统仍然是编程的核心组件，想想那些使用isinstance判断变量类型、应用逻辑所浪费的时间吧。
3、 易于使用库
使用类型提示意味着IDE可以拥有更准确、更智能的建议引擎。当调用自动完成时，IDE会完全放心地知道对象上有哪些方法/属性可用。此外，如果用户尝试调用不存在的内容或传递不正确类型的参数，IDE可以立即警告它。
4、验证运行数据
类型标注（Type annotations）是一种直接的方式，并且是类型文档中最常见到的那种方式。

使用：语句将信息附加到变量或函数参数中。，
->运算符用于将信息附加到函数/方法的返回值中。

好处：
这是实现类型提示的规范方式，这意味着是类型提示中最干净的一种方式。
因为类型信息附加在代码的右侧，这样我们可以立刻明晰类型。

缺点：
它不向后兼容。至少需要Python 3.6才能使用它。
强制你导入所有类型依赖项，即使它们根本不在运行时使用。
在类型提示中，会使用到复合类型，例如List\[int]。而为了构造这些复杂类型，解释器在首次加载此文件时需要执行一些操作。

类型标注的使用
类型标注（Type annotations）是一种直接的方式，并且是类型文档中最常见到的那种方式。
声明一个函数参数的类型，只要在参数名称的后面加个":“号，带上类型名称就行了。声明函数的返回值类型，只要在函数声明结束之前，也就是”:“号之前加入一个”->"，带上类型名称。
常见数据类型

int,long,float: 整型,长整形,浮点型
bool,str: 布尔型，字符串类型
List, Tuple, Dict, Set:列表，元组，字典, 集合
Iterable,Iterator:可迭代类型，迭代器类型
Generator：生成器类型

1. 基本数据类型

```
def test(a:int, b:str) -> str:
    print(a, b)
    return 1000

if __name__ == '__main__':
    test('test', 'abc')
```

函数test，a:int 指定了输入参数a为int类型，b:str b为str类型，-> str 返回值为srt类型。

可以看到，在方法中，我们最终返回了一个int，此时pycharm就会有警告；
当我们在调用这个方法时，参数a我们输入的是字符串，此时也会有警告；

但非常重要的一点是，pycharm只是提出了警告，但实际上运行是不会报错，毕竟<font color=red>python的本质还是动态语言</font>
